[
    {
        "scene_index": "0",
        "descriptions": [
            {
                "required_flags": "",
                "text": "You rummage around in your pockets"
            }
        ],
        "actions": [
            {
                "message": "Key ring",
                "description": "A whole bunch of keys, maybe one of them leads to freedom!",
                "required_flags": "has_key"
            },
            {
                "message": "File",
                "description": "A rusty file. It would make quick work of a certain few metal bars.",
                "required_flags": "has_file"
            },
            {
                "message": "Large book",
                "description": "A large musty tome containing information on herbalism.",
                "required_flags": "has_book"
            },
            {
                "message": "Herb",
                "description": "The herbology book suggests these if you’re suffering from insomnia.",
                "required_flags": "has_herb"
            },
            {
                "message": "A leg",
                "description": "It’s something to stand on.",
                "required_flags": "has_leg"
            },
            {
                "message": "Arm",
                "description": "It’s a constitutional right to bear one.",
                "required_flags": "has_arm"
            },
            {
                "message": "Boomerang",
                "description": "It doesn’t make a boom. That’s a real bummer.",
                "required_flags": "has_boomerang"
            },
            {
                "message": "Bucket",
                "description": "It’s a sturdy old water bucket. It's so large your head could comfortably fit in it.",
                "required_flags": "has_bucket"
            },
            {
                "message": "Go back",
                "description": "You get back to the matter at hand.",
                "required_flags": "",
                "go_to_scene": "1"
            }
        ]
    },
    {
        "scene_index": "1",
        "descriptions": [
            {
                "required_flags": "",
                "text": "You awaken in a damp cell. You are scheduled for execution. With a slight preference for living you decide to escape instead."
            }
        ],
        "actions": [
            {
                "message": "Explore the room",
                "description": "You stand up and take a look around.",
                "go_to_scene": "2"
            },
            {
                "message": "Go to sleep",
                "description": "You go back to sleep.",
                "go_to_scene": "1"
            }
        ]
    },
    {
        "scene_index": "2",
        "descriptions": [
            {
                "required_flags": "door_unlocked, box_moved",
                "text": "The metal door stands open. The wooden box stands under the ceiling grate. The floor is cold stone covered in rubble."
            },
            {
                "required_flags": "door_unlocked",
                "text": "The metal door stands open. The only source of light is a grated opening in the ceiling. The floor is cold stone covered in rubble."
            },
            {
                "required_flags": "box_moved",
                "text": "A heavy door bars the exit. The wooden box stands under the ceiling grate. The floor is cold stone covered in rubble."
            },
            {
                "required_flags": "",
                "text": "A heavy door bars the exit. The only source of light is a grated opening in the ceiling. The floor is cold stone covered in rubble."
            }
        ],
        "actions": [
            {
                "message": "Approach the door",
                "description": "You step towards the only apparent exit.",
                "required_flags": "!door_unlocked",
                "go_to_scene": "3"
            },
            {
                "message": "Go through the door",
                "description": "You walk past the open metal door.",
                "required_flags": "door_unlocked",
                "go_to_scene": "6"
            },
            {
                "message": "Examine the floor",
                "description": "You examine the floor, perhaps there is something useful there?",
                "go_to_scene": "4"
            },
            {
                "message": "Check the ceiling grate",
                "description": "It’s the only source of light in here.",
                "go_to_scene": "5"
            }
        ]
    },
    {
        "scene_index": "3",
        "descriptions": [
            {
                "required_flags": "",
                "text": "A closed metal door stands before you. It seems old and rusted, though it’s far too sturdy to break through."
            }
        ],
        "actions": [
            {
                "message": "Unlock the door",
                "description": "The key turns slowly but steadily and the old lock gives a loud click.",
                "required_flags": "has_key",
                "go_to_scene": "6"
            },
            {
                "message": "Knock",
                "description": "No one answers",
                "perform_once": true
            },
            {
                "message": "Open",
                "description": "It won’t budge",
                "perform_once": true
            },
            {
                "message": "Go back",
                "description": "You turn away from the door.",
                "go_to_scene": "2"
            }
        ]
    },
    {
        "scene_index": "4",
        "descriptions": [
            {
                "required_flags": "box_moved",
                "text": "The uneven stone floor is cold, hard and dirty. In one corner lies a pile of straw as a sad mockery of a bed"
            },
            {
                "required_flags": "",
                "text": "The uneven stone floor is cold, hard and dirty. In one corner lies a pile of straw as a sad mockery of a bed and in another stands a wooden box."
            }
        ],
        "actions": [
            {
                "message": "Inspect the box",
                "description": "The wooden box catches your eye.",
                "required_flags": "!box_moved",
                "go_to_scene": "7"
            },
            {
                "message": "Sit on bed",
                "description": "It’s just as uncomfortable as when you woke up",
                "perform_once": true
            },
            {
                "message": "Go back",
                "description": "You rise from the floor",
                "go_to_scene": "2"
            }
        ]
    },
    {
        "scene_index": "5",
        "descriptions": [
            {
                "required_flags": "box_moved",
                "text": "A small grate sits in the ceiling letting through the candle light and snores from the room above. You could probably squeeze through if you could get rid of the bars. The wooden box stands right beneath it."
            },
            {
                "required_flags": "",
                "text": "A small grate sits in the ceiling letting through the candle light and snores from the room above. You could probably squeeze through if you could get rid of the bars."
            }
        ],
        "actions": [
            {
                "message": "Try to reach",
                "description": "You try to reach the metal bars but it’s too high up.",
                "perform_once": true
            },
            {
                "message": "Climb the box",
                "description": "Now you’re thinking outside it!",
                "required_flags": "box_moved",
                "go_to_scene": "8"
            },
            {
                "message": "Go back",
                "description": "You turn back to the rest of the cell.",
                "go_to_scene": "2"
            }
        ]
    },
    {
        "scene_index": "6",
        "descriptions": [
            {
                "required_flags": "in_first_cell",
                "text": "The door is ajar. Before you lies another prison cell, this one even more run down."
            },
            {
                "required_flags": "!in_first_cell",
                "text": "The door is ajar. Before you lies your original cell. It’s a bit nicer."
            }
        ],
        "actions": [
            {
                "message": "Go into the other cell",
                "description": "You step through the doorway.",
                "set_flags": "!in_first_cell",
                "go_to_scene": "9"
            },
            {
                "message": "Go back to your cell",
                "description": "You turn back to the rest of the cell.\n",
                "set_flags": "in_first_cell",
                "go_to_scene": "2"
            }
        ]
    },
    {
        "scene_index": "7",
        "descriptions": [
            {
                "required_flags": "",
                "text": "A wooden box stands alone in a corner. It seems to be much newer than most things in the room. A note says “Don’t mess with the superposition”"
            }
        ],
        "actions": [
            {
                "message": "Push it real good",
                "description": "You push it under the grate.",
                "required_flags": "!box_moved",
                "set_flags": "box_moved",
                "perform_once": true
            },
            {
                "message": "Check inside",
                "description": "You find a dead cat.",
                "required_flags": "cat_be_ded, !box_moved",
                "perform_once": true
            },
            {
                "message": "Check inside",
                "description": " A confused cat stares back at you.",
                "required_flags": "!cat_be_ded, !box_moved",
                "perform_once": true
            },
            {
                "message": "Go back",
                "description": "You step away from the corner.",
                "go_to_scene": "2"
            }
        ]
    },
    {
        "scene_index": "8",
        "descriptions": [
            {
                "required_flags": "",
                "text": "As you peek through the grate you see a long corridor. A guard lays sleeping on a nearby bench. On the floor stands a mug filled with something."
            }
        ],
        "actions": [
            {
                "message": "Reach for the sleeping guard",
                "description": "Careful not to wake him!",
                "go_to_scene": "10"
            },
            {
                "message": "Reach for the guards drink",
                "description": "Surely he wouldn’t mind?",
                "required_flags": "!herb_mah_drink",
                "go_to_scene": "11"
            },
            {
                "message": "File the bars",
                "description": "The guard snores loudly as you file",
                "required_flags": "has_file, sleepy_guard, !file_bars_1",
                "set_flags": "file_bars_1"
            },
            {
                "message": "Continue filing the bars",
                "description": "The amount of noise makes you feel thankful for the herbs",
                "required_flags": "has_file, sleepy_guard, file_bars_1, !file_bars_2",
                "set_flags": "file_bars_2"
            },
            {
                "message": "Continue filing the bars",
                "description": "TODO you escape!",
                "required_flags": "has_file, sleepy_guard, file_bars_2, !file_bars_3",
                "set_flags": "file_bars_3"
            },
            {
                "message": "File the bars",
                "description": "The guard stirs at the screeching sound",
                "required_flags": "has_file, !file_bars_1, !sleepy_guard",
                "set_flags": "file_bars_1"
            },
            {
                "message": "Continue filing the bars",
                "description": "The guard wakes",
                "required_flags": "has_file, file_bars_1, !sleepy_guard, !file_bars_2",
                "set_flags": "file_bars_2"
            },
            {
                "message": "Continue filing the bars",
                "description": "TODO Get Caught",
                "required_flags": "has_file, file_bars_2, !sleepy_guard, !file_bars_3",
                "set_flags": "file_bars_3"
            },
            {
                "message": "Climb back down",
                "description": "You climb back down to the floor.",
                "set_flags": "!file_bars_1, !file_bars_2, !file_bars_3",
                "go_to_scene": "2"
            }
        ]
    },
    {
        "scene_index": "9",
        "descriptions": [
            {
                "required_flags": "slab_lifted",
                "text": "This cell hasn't had a living occupant in some time, made obvious by the corpse slumped in a corner. Against the opposite wall of the door stands a rickety table. The center of the floor disappears into a dark hole."
            },
            {
                "required_flags": "!slab_lifted",
                "text": "This cell hasn't had a living occupant in some time, made obvious by the corpse slumped in a corner. Against the opposite wall of the door stands a rickety table. The center of the floor is covered by a large slab of wood"
            }
        ],
        "actions": [
            {
                "message": "Check the table",
                "description": "You head on over to the table.",
                "go_to_scene": "12"
            },
            {
                "message": "Examine the corpse",
                "description": "Haven’t you been told to stay away from dead bodies?",
                "go_to_scene": "13"
            },
            {
                "message": "Approach the wooden slab",
                "description": "It does look a bit out of place.",
                "required_flags": "!slab_lifted",
                "go_to_scene": "14"
            },
            {
                "message": "Approach the hole in the floor",
                "description": "Careful not to trip!",
                "required_flags": "slab_lifted",
                "go_to_scene": "15"
            },
            {
                "message": "Return to the doorway",
                "description": "Sometimes you need to step back before you step forward",
                "go_to_scene": "6"
            }
        ]
    },
    {
        "scene_index": "10",
        "descriptions": [
            {
                "required_flags": "has_key",
                "text": "The unkempt guard is snoring loudly. His belt locks lonely without the keyring."
            },
            {
                "required_flags": "!has_key",
                "text": "The unkempt guard is snoring loudly. From his belt dangles a key ring with an array of different coloured and shaped keys."
            }
        ],
        "actions": [
            {
                "message": "Take the keys",
                "description": "You sneakily slide the key ring of the guards belt. You only make a lot of noise, but the guard doesn’t notice.",
                "perform_once": true,
                "set_flags": "has_key"
            },
            {
                "message": "Wake the guard",
                "description": "He scowls at you, takes a swig from the mug and then promptly goes back to sleep",
                "required_flags": "!herb_mah_drink"
            },
            {
                "message": "Wake the guard",
                "description": "He scowls at you, downs the rest of the mug and then promptly goes back to sleep. If the herbology book was right it ought to be a deep sleep",
                "required_flags": "herb_mah_drink",
                "perform_once": true,
                "set_flags": "sleepy_guard"
            },
            {
                "message": "Reach for something else",
                "description": "Better not risk it",
                "go_to_scene": "8"
            }
        ]
    },
    {
        "scene_index": "11",
        "descriptions": [
            {
                "required_flags": "",
                "text": "A mug stands on the floor next to the bench. It is half full, or half empty."
            }
        ],
        "actions": [
            {
                "message": "Pick it up",
                "description": "It doesn’t fit through the grate.",
                "perform_once": true
            },
            {
                "message": "Spit in it",
                "description": "Were you never taught table manners?",
                "perform_once": true
            },
            {
                "message": "Put the herb in it",
                "description": "You put the herb in the drink.",
                "required_flags": "has_herb",
                "set_flags": "!has_herb",
                "perform_once": true
            },
            {
                "message": "Leave the mug be",
                "description": "You reach for something else.",
                "go_to_scene": "8"
            }
        ]
    },
    {
        "scene_index": "12",
        "descriptions": [
            {
                "required_flags": "!has_book",
                "text": "The table wobbles as you step closer to it. Atop it rests a moldy tome of herb-lore."
            },
            {
                "required_flags": "has_book",
                "text": "The table wobbles as you step closer to it. There's nothing but dust and cloth scraps on it"
            }
        ],
        "actions": [
            {
                "message": "Pick up the herbology book.",
                "description": "Now you know a lot more about plants!\n",
                "required_flags": "!has_book",
                "set_flags": "has_book"
            },
            {
                "message": "Turn back to the rest of the room",
                "description": "Let’s table this topic for now.",
                "go_to_scene": "9"
            }
        ]
    },
    {
        "scene_index": "13",
        "descriptions": [
            {
                "required_flags": "",
                "text": "The prisoner’s body sits half leaning against a corner. It’s past the process of decay and doesn’t smell too bad. It’s dressed in similar rags to yourself."
            }
        ],
        "actions": [
            {
                "message": "Search the corpse’s pocketses",
                "description": "You find a precious file.",
                "required_flags": "!has_file",
                "set_flags": "has_file",
                "perform_once": true
            },
            {
                "message": "Back away",
                "description": "You let your disgust get the better of you.",
                "go_to_scene": "9"
            }
        ]
    },
    {
        "scene_index": "14",
        "descriptions": [
            {
                "required_flags": "",
                "text": "A large slab of wood rests on the floor. It looks heavy, but you are strong."
            }
        ],
        "actions": [
            {
                "message": "Lift the slab of wood",
                "description": "The wood creaks loudly. Or was that your back?",
                "set_flags": "slab_lifted",
                "go_to_scene": "15"
            },
            {
                "message": "Look at something else",
                "description": "You didn't even lift bro.",
                "go_to_scene": "9"
            }
        ]
    }
]
